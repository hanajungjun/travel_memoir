// ---------------------------------------------------------------------------
// üóìÔ∏è Date Formatter Utilities
// Í¥ÄÎ¶¨/ÌôïÏû• ÏâΩÍ≤å ÌïòÎ†§Í≥† Í∏∞Îä•Î≥ÑÎ°ú Î≤àÌò∏ Îß§Í≤® Íµ¨ÏÑ±Ìï®
// ---------------------------------------------------------------------------
//
// 1) Í∏∞Î≥∏ Ìè¨Îß∑ (YYYY.MM.DD HH:mm)
// 2) ÏãúÍ∞ÑÎßå Ìè¨Îß∑ (HH:mm)
// 3) ÏÉÅÎåÄ ÏãúÍ∞Ñ ("3Î∂Ñ Ï†Ñ", "2ÏãúÍ∞Ñ Ï†Ñ", "Ïñ¥Ï†ú")
// 4) Ïä§ÎßàÌä∏ Ìè¨Îß∑ (Ïò§ÎäòÏù¥Î©¥ ÏãúÍ∞ÑÎßå)
// 5) ÏöîÏùº ÌÖçÏä§Ìä∏
// 6) Ïù¥Î≤à Ï£º Ïä§ÎßàÌä∏ Ìè¨Îß∑ ("ÏõîÏöîÏùº 14:22")
// 7) Ïò¨Ìï¥Î©¥ MM.DD HH:mm ÌòïÏãùÏúºÎ°ú
//
// ---------------------------------------------------------------------------

// ÎÇ¥Î∂ÄÏóêÏÑú Ïì∞Îäî 2ÏûêÎ¶¨ Ïà´Ïûê Î≥ÄÌôò
String two(int n) => n.toString().padLeft(2, '0');

// ---------------------------------------------------------------------------
// 1) Í∏∞Î≥∏ ÎÇ†Ïßú Ìè¨Îß∑: YYYY.MM.DD HH:mm
// ---------------------------------------------------------------------------
String formatDate(DateTime dt) {
  return "${dt.year}.${two(dt.month)}.${two(dt.day)} "
      "${two(dt.hour)}:${two(dt.minute)}";
}

// ---------------------------------------------------------------------------
// 2) ÏãúÍ∞ÑÎßå ÌëúÏãú (HH:mm)
// ---------------------------------------------------------------------------
String formatTime(DateTime dt) {
  return "${two(dt.hour)}:${two(dt.minute)}";
}

// ---------------------------------------------------------------------------
// 3) ÏÉÅÎåÄ ÏãúÍ∞Ñ ("Î∞©Í∏à Ï†Ñ", "3Î∂Ñ Ï†Ñ", "2ÏãúÍ∞Ñ Ï†Ñ", "Ïñ¥Ï†ú", "3Ïùº Ï†Ñ")
// ---------------------------------------------------------------------------
String formatRelative(DateTime dt) {
  final now = DateTime.now();
  final diff = now.difference(dt);

  if (diff.inMinutes < 1) return "Î∞©Í∏à Ï†Ñ";
  if (diff.inMinutes < 60) return "${diff.inMinutes}Î∂Ñ Ï†Ñ";
  if (diff.inHours < 24) return "${diff.inHours}ÏãúÍ∞Ñ Ï†Ñ";
  if (diff.inDays == 1) return "Ïñ¥Ï†ú";
  if (diff.inDays < 7) return "${diff.inDays}Ïùº Ï†Ñ";

  return formatDate(dt);
}

// ---------------------------------------------------------------------------
// 4) Ïä§ÎßàÌä∏ Ìè¨Îß∑: Ïò§ÎäòÏù¥Î©¥ ÏãúÍ∞ÑÎßå, ÏïÑÎãàÎ©¥ Í∏∞Î≥∏ ÎÇ†Ïßú Ìè¨Îß∑
// ---------------------------------------------------------------------------
String formatSmart(DateTime dt) {
  final now = DateTime.now();

  final sameDay =
      (dt.year == now.year) && (dt.month == now.month) && (dt.day == now.day);

  if (sameDay) {
    return "Ïò§Îäò ${formatTime(dt)}";
  }

  return formatDate(dt);
}

// ---------------------------------------------------------------------------
// 5) ÏöîÏùº ÌÖçÏä§Ìä∏ (ÏõîÏöîÏùº~ÏùºÏöîÏùº)
// ---------------------------------------------------------------------------
String getWeekdayKor(int weekday) {
  const map = {
    1: "ÏõîÏöîÏùº",
    2: "ÌôîÏöîÏùº",
    3: "ÏàòÏöîÏùº",
    4: "Î™©ÏöîÏùº",
    5: "Í∏àÏöîÏùº",
    6: "ÌÜ†ÏöîÏùº",
    7: "ÏùºÏöîÏùº",
  };
  return map[weekday] ?? "";
}

// ---------------------------------------------------------------------------
// 6) Ïù¥Î≤à Ï£ºÎ©¥ "ÏõîÏöîÏùº HH:mm", ÏïÑÎãàÎ©¥ Í∏∞Î≥∏ ÎÇ†Ïßú Ìè¨Îß∑
// ---------------------------------------------------------------------------
String formatWeekSmart(DateTime dt) {
  final now = DateTime.now();
  final diff = dt.difference(now).inDays.abs();

  if (diff < 7) {
    return "${getWeekdayKor(dt.weekday)} ${formatTime(dt)}";
  }

  return formatDate(dt);
}

// ---------------------------------------------------------------------------
// 7) Ïò¨Ìï¥Î©¥ "MM.DD HH:mm", Îã§Î•∏ Ìï¥Î©¥ Í∏∞Î≥∏ Ìè¨Îß∑
// ---------------------------------------------------------------------------
String formatYearSmart(DateTime dt) {
  final now = DateTime.now();

  if (dt.year == now.year) {
    return "${two(dt.month)}.${two(dt.day)} ${formatTime(dt)}";
  }

  return formatDate(dt);
}
